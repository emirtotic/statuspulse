{% extends "base.html" %}

{% block title %}Dashboard - StatusPulse{% endblock title %}

{% block content %}
<body>
<header>
    <h1>StatusPulse</h1>
    <nav>
        <a href="/dashboard">Dashboard</a> |
        <a href="/logout">Logout</a> |
    </nav>
    <hr>
</header>
<div class="container">
    <h2 style="text-align: center;">Your Monitors</h2>

    {% if monitors | length == 0 %}
    <p>You have no monitors yet. <a href="/monitors/new">Add your first monitor</a></p>
    {% else %}
    <table style="width: 100%; border-collapse: collapse; margin-top: 1rem;">
        <thead>
        <tr>
            <th style="border-bottom: 1px solid #ccc; padding: 8px;">Label</th>
            <th style="border-bottom: 1px solid #ccc; padding: 8px;">URL</th>
            <th style="border-bottom: 1px solid #ccc; padding: 8px;">Status</th>
            <th style="border-bottom: 1px solid #ccc; padding: 8px;">Interval (mins)</th>
            <th style="border-bottom: 1px solid #ccc; padding: 8px;">Uptime (%)</th>
            <th style="border-bottom: 1px solid #ccc; padding: 8px;">Actions</th>
        </tr>
        </thead>
        <tbody>
        {% for monitor in monitors %}
        <tr>
            <td style="padding: 8px;">{{ monitor.label }}</td>
            <td style="padding: 8px; max-width: 300px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">
                <a href="{{ monitor.url }}" target="_blank">
                    {{ monitor.url | truncate(length=50, end="...") }}
                </a>
            </td>
            <td style="padding: 8px;">
                {% if monitor.is_active %}
                <span style="color: green;">Active</span>
                {% else %}
                <span style="color: red;">Inactive</span>
                {% endif %}
            </td>
            <td style="padding: 8px;">{{ monitor.interval_mins }}</td>
            <td style="padding: 8px;">
                {% if monitor.uptime_percentage is defined %}
                {{ monitor.uptime_percentage | round(precision=2) }}%
                {% else %}
                N/A
                {% endif %}
            </td>
            <td style="padding: 8px;">
                <form action="/monitors/{{ monitor.id }}/delete" method="post" style="display:inline;" onsubmit="return confirm('Are you sure you want to delete this monitor?');">
                    <button type="submit">Delete</button>
                </form>
                &nbsp;
                <a href="/monitors/{{ monitor.id }}/edit">Edit</a>
            </td>
        </tr>
        {% endfor %}
        </tbody>
    </table>
    {% endif %}

    <div style="margin-top: 2rem;">
        <a href="/monitors/new" style="padding: 8px 16px; background-color: #4CAF50; color: white; text-decoration: none; border-radius: 4px;">Add New Monitor</a>
    </div>

    <div style="margin-top: 1rem;">
        <a href="/logout" style="color: red;">Logout</a>
    </div>
</div>

</body>
{% endblock content %}
